<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
<title>DSPI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Dynamic Stream Processing Interface">
<meta name="keywords" content="DSPI">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link id="dynamic-favicon" rel="shortcut icon" href="favicon.svg">
    <!-- Bootstrap core CSS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<style>
input, select, option{
	font-weight:bold;
}
input[type=button], input[type=submit]{
	padding-left:15px;
	padding-right:15px;
	padding-top:2px;
	padding-bottom:2px;
}
a {
	font-weight: bold;
	text-decoration: none;
}
#menu a,#menu input, #menu button{
	font-family: tahoma, arial;
	font-size:13px;
	text-shadow: 3px 3px 3px #000000;
	font-weight: bold;
	text-decoration: none;
}
#mainBody{
	font-family: Georgia, Arial, Helvetica, sans-serif;
	font-size: 1em;
	line-height: 1.3em;
}
</style>
<style>
html,
body {
	padding-bottom: 70px;
overflow-x: hidden;
}

body {
padding-top: 56px;
}

@media (min-width: 800px) {
  .navbar-icon-top.navbar-expand-lg .navbar-nav .nav-link {
    text-align: center;
    display: table-cell;
    height: 40px;
    vertical-align: middle;
    padding-top: 0;
    padding-bottom: 0;
	font-size:0.75em;
  }

  .navbar-icon-top.navbar-expand-lg .navbar-nav .nav-link > .fa {
    display: block;
    width: 36px;
    margin: 2px auto 4px auto;
    top: 0;
    line-height: 24px;
  }
}
</style>
</head>
<body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-icon-top fixed-top navbar-dark bg-dark">
		<a class="navbar-brand mr-auto mr-lg-0" href="#" style="pointer-events: none;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;">
			<svg aria-hidden="true" width="2em" height="2em" focusable="false" data-prefix="far" data-icon="image" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fa svg-inline--fa fa-image fa-w-16">
				<path fill="currentColor" d="M18,6H17V2H15V6H13V2H11V6H9V2H7V6H6V7H2V9H6v2H2v2H6v2H2v2H6v1H7v4H9V18h2v4h2V18h2v4h2V18h1V17h4V15H18V13h4V11H18V9h4V7H18ZM16,16H8V8h8Z"/>
				</path>
			</svg>DSPI
		</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapseTop" aria-controls="navbarCollapseTop" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>





		<div class="collapse navbar-collapse" id="navbarCollapseTop">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item">
					<a class="nav-link text-nowrap navbar-right" href="interfaceDef/">
						<svg aria-hidden="true" width="2em" height="2em" focusable="false" data-prefix="far" data-icon="image" class="fa svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
							<path fill="currentColor" d="M2.71,22.71l2.4-2.4a3.79,3.79,0,0,0,4.6-.6L12.41,17l-1-1,2.29-2.29-1.41-1.41L10,14.59,9.41,14l2.29-2.29-1.41-1.41L8,12.59l-1-1L4.29,14.29a3.82,3.82,0,0,0-.6,4.6l-2.4,2.4Zm3-7L7,14.41,9.59,17,8.29,18.29a1.83,1.83,0,0,1-2.59-2.59Z">
							</path>
							<path fill="currentColor" d="M18.89,3.69a3.82,3.82,0,0,0-4.6.6L11.59,7,17,12.41l2.71-2.71a3.82,3.82,0,0,0,.6-4.6l2.4-2.4L21.29,1.29Zm-.6,4.6L17,9.59,14.41,7l1.29-1.29a1.83,1.83,0,0,1,2.59,2.59Z">
							</path>
						</svg>
						Interface Definition
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link text-nowrap navbar-right" href="blockGen/">
						<svg aria-hidden="true" width="2em" height="2em" focusable="false" data-prefix="far" data-icon="image" class="fa svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
							<path fill="currentColor" d="M29,0H3A3,3,0,0,0,0,3V29a3,3,0,0,0,3,3H29a3,3,0,0,0,3-3V3A3,3,0,0,0,29,0ZM2,3A1,1,0,0,1,3,2H15V7H2ZM22,9v6H10V9ZM2,9H8v6H2Zm0,8H15v6H2ZM8,30H3a1,1,0,0,1-1-1V25H8Zm14,0H10V25H22Zm8-1a1,1,0,0,1-1,1H24V25h6Zm0-6H17V17H30Zm0-8H24V9h6Zm0-8H17V2H29a1,1,0,0,1,1,1Z">
							</path>
						</svg>
						Blocker Generation
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link text-nowrap navbar-right" href="blockGen/">
						<svg aria-hidden="true" width="2em" height="2em" focusable="false" data-prefix="far" data-icon="image" class="fa svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 84">
							<path fill="currentColor" d="M64,12c0-6.627-5.373-12-12-12c-6.627,0-12,5.373-12,12c0,4.865,2.901,9.045,7.062,10.93  c-1.137,9.738-7.42,11.705-16.479,14.537c-4.395,1.373-9.511,2.977-13.833,6.082V23.02C21.014,21.178,24,16.939,24,12  c0-6.627-5.373-12-12-12C5.373,0,0,5.373,0,12c0,4.939,2.986,9.178,7.25,11.02v37.963C2.986,62.822,0,67.061,0,72  c0,6.627,5.373,12,12,12c6.627,0,12-5.373,12-12c0-4.865-2.9-9.045-7.062-10.928c1.137-9.74,7.42-11.707,16.479-14.537  c9.22-2.881,21.628-6.762,23.172-23.447C60.938,21.285,64,17,64,12z M5.077,12c0-3.822,3.101-6.922,6.923-6.922  c3.823,0,6.923,3.1,6.923,6.922c0,3.824-3.1,6.924-6.923,6.924C8.178,18.924,5.077,15.824,5.077,12z M12,78.924  c-3.822,0-6.923-3.1-6.923-6.924c0-3.822,3.101-6.922,6.923-6.922c3.823,0,6.923,3.1,6.923,6.922  C18.923,75.824,15.823,78.924,12,78.924z M52,18.924c-3.822,0-6.923-3.1-6.923-6.924c0-3.822,3.101-6.922,6.923-6.922  c3.823,0,6.923,3.1,6.923,6.922C58.923,15.824,55.823,18.924,52,18.924z">
							</path>
						</svg>
						Placeholder
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link text-nowrap navbar-right" href="blockGen/">
						<svg aria-hidden="true" width="2em" height="2em" focusable="false" data-prefix="far" data-icon="image" class="fa svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
							<path fill="currentColor" d="M5.977417,16.5018311H2v26h2v-24h1.9786377c0.5351563,3.9372559,4.161438,6.9963379,8.5445557,6.9963379h7.3799438v-16   h-7.3799438C10.1373291,9.4981689,6.5090942,12.5610962,5.977417,16.5018311z">
							</path>
							<path fill="currentColor" d="M45.840332,16.5018311c-0.4492798-3.9407349-3.5161133-7.0036621-7.2371826-7.0036621H37v16h1.6031494   c3.71875,0,6.7838745-3.059082,7.236145-6.9963379H48v24h2v-26H45.840332z">
							</path>
							<rect fill="currentColor" height="16" width="11.1000366" x="23.9031372" y="9.4981689"/>
						</svg>
						Placeholder
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link text-nowrap navbar-right" href="blockGen/">
						<svg aria-hidden="true" width="2em" height="2em" focusable="false" data-prefix="far" data-icon="image" class="fa svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
							<path fill="currentColor" d="M38,1H1v34h4v7.414L12.414,35H17v6h17.586L43,49.414V41h6V15H38V1z M11.586,33L7,37.586V33H3V13h7v7.184   C8.839,20.598,8,21.698,8,23c0,1.654,1.346,3,3,3s3-1.346,3-3c0-1.302-0.839-2.402-2-2.816V11H3V3h33v5H23.816   C23.402,6.839,22.302,6,21,6c-1.654,0-3,1.346-3,3s1.346,3,3,3c1.302,0,2.402-0.839,2.816-2H36v5H17v18H11.586z M12,23   c0,0.552-0.448,1-1,1s-1-0.448-1-1s0.448-1,1-1S12,22.448,12,23z M22,9c0,0.552-0.448,1-1,1s-1-0.448-1-1s0.448-1,1-1   S22,8.448,22,9z M47,17v16h-6.184c-0.414-1.161-1.514-2-2.816-2c-1.654,0-3,1.346-3,3s1.346,3,3,3c1.302,0,2.402-0.839,2.816-2H47   v4h-6v5.586L35.414,39H19v-4V24h7v3.184c-1.161,0.414-2,1.514-2,2.816c0,1.654,1.346,3,3,3s3-1.346,3-3   c0-1.302-0.839-2.402-2-2.816V22h-9v-5h13v8h6.184c0.414,1.161,1.514,2,2.816,2c1.654,0,3-1.346,3-3s-1.346-3-3-3   c-1.302,0-2.402,0.839-2.816,2H34v-6h4H47z M39,34c0,0.552-0.448,1-1,1s-1-0.448-1-1s0.448-1,1-1S39,33.448,39,34z M28,30   c0,0.552-0.448,1-1,1s-1-0.448-1-1s0.448-1,1-1S28,29.448,28,30z M40,24c0-0.552,0.448-1,1-1s1,0.448,1,1s-0.448,1-1,1   S40,24.552,40,24z">
							</path>
						</svg>
						Placeholder
					</a>
				</li>
			</ul>
		</div>
	</nav>
<main role="main" class="container" style="min-width:400px;">
<div class="my-3 p-3 bg-white rounded shadow-sm table-responsive" id="maindiv">




















<form><input type="file" id="fileinput"/><button class="btn btn-primary" id="upload" type="button"><i class="fa fa-upload"></i> Open</button></form> 
<button class="btn btn-info" id="download" type="button"><i class="fa fa-download"></i> Save</button> 
<button class="btn btn-warning" id="draw" type="button"><i class="fa fa-microchip"></i> Draw</button> 

    <legend>Interface</legend>
<fieldset id="interfacefieldset">

<div class="fieldwrapper control-group input-group" style="margin-top:10px" id="headeritem">
<input readonly type="text" class="form-control form-control-sm" value="Bus/wire name"/>
<input readonly type="text" class="form-control form-control-sm" value="LSB"/>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1">Border</option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1">Direction</option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1">Width</option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1">Clock Region</option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1">Tile</option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1">Wire(s)</option></select>
<button class="btn btn-sm btn-danger remove btn-block" type="button" style="width:85px !important;"><i class="fa fa-remove"></i> Remove</button>
</div>


</fieldset>

<div class="fieldwrapper control-group input-group" style="margin-top:10px" id="headeritem">
<input readonly type="text" class="form-control form-control-sm" value=""/>
<input readonly type="text" class="form-control form-control-sm" value=""/>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1"></option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1"></option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1"></option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1"></option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1"></option></select>
<select disabled="true" class="custom-select custom-select-sm" aria-label=".custom-select-sm"><option value="1"></option></select>
<button class="btn btn-sm btn-success btn-block" id="add" type="button" style="width:85px !important;"><i class="fa fa-plus"></i> Add </button>
</div>
<div id="editor"></div>
<br /><br /><hr /><br /><br />

<script type="text/javascript">
function download(filename, text) {
  var element = document.createElement('a');
  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
  element.setAttribute('download', filename);

  element.style.display = 'none';
  document.body.appendChild(element);

  element.click();

  document.body.removeChild(element);
}
var fr;
function receivedText() {
document.getElementById('editor').appendChild(document.createTextNode(fr.result));
}
var interfaceRows = 0;
var interfaceNames = [];
var interfaceLSBs = [];
var interfaceBorders = [];
var interfaceDirections = [];
var interfaceWidths = [];
var interfaceClockRegions = [];
var interfaceTiles = [];
var interfaceWires = [];
function readFromUI(){
	interfaceRows = 0;
	interfaceNames = [];
	interfaceLSBs = [];
	interfaceBorders = [];
	interfaceDirections = [];
	interfaceWidths = [];
	interfaceClockRegions = [];
	interfaceTiles = [];
	interfaceWires = [];
	$("#interfacefieldset div").each(function() {
		//var id = "input" + $(this).attr("id").replace("field","");
		console.log($(this));
		if($(this).attr("id").includes("field")) {
			interfaceNames.push($(this).find("input.fieldname").first().val());
			interfaceLSBs.push($(this).find("input.fieldlsb").first().val());
			interfaceBorders.push($(this).find("select.fieldborder").first().val());
			interfaceDirections.push($(this).find("select.fielddirection").first().val());
			interfaceWidths.push($(this).find("select.fieldwidth").first().val());
			interfaceClockRegions.push($(this).find("select.fieldclockregion").first().val());
			interfaceTiles.push($(this).find("select.fieldtile").first().val());
			interfaceWires.push($(this).find("select.fieldwire").first().val());
			interfaceRows++;
		}
	});
}
function canvasLine(context, color, fromx, fromy, tox, toy){
			context.fillStyle = color;
			
			context.beginPath();
			context.moveTo(fromx, fromy);
			context.lineTo(tox, toy);
			context.stroke(); 
}
function canvasArrow(context, color, fromx, fromy, tox, toy) {
  context.fillStyle = color;
  var headlen = 5; // length of head in pixels
  var dx = tox - fromx;
  var dy = toy - fromy;
  var angle = Math.atan2(dy, dx);
  context.moveTo(fromx, fromy);
  context.lineTo(tox, toy);
  context.lineTo(tox - headlen * Math.cos(angle - Math.PI / 6), toy - headlen * Math.sin(angle - Math.PI / 6));
  context.moveTo(tox, toy);
  context.lineTo(tox - headlen * Math.cos(angle + Math.PI / 6), toy - headlen * Math.sin(angle + Math.PI / 6));
  context.stroke(); 
}
function canvasRectangleWithBorder(context, alpha, fillColor, borderColor, borderThickness, fromx, fromy, tox, toy){
	canvasRectangle(context, alpha, borderColor, fromx,fromy,tox,toy);
	canvasRectangle(context, alpha, fillColor, fromx+borderThickness,fromy+borderThickness,tox-borderThickness,toy-borderThickness);
}
function canvasRectangle(context, alpha, color, fromx, fromy, tox, toy){
	context.fillStyle = color;
	context.globalAlpha = alpha;
    context.fillRect(fromx,fromy,tox,toy);
    context.globalAlpha = 1.0;
}
$(document).ready(function() {
    $("#add").click(function() {
        var lastField = $("#interfacefieldset div:last");
        var intId = (lastField && lastField.length && lastField.data("idx") + 1) || 1;
        var fieldWrapper = $("<div class=\"fieldwrapper control-group input-group\" style=\"margin-top:10px\" id=\"field" + intId + "\">");
        fieldWrapper.data("idx", intId);
        var fName = $("<input type=\"text\" class=\"form-control form-control-sm fieldname\" />");
        var fLSB = $("<input type=\"text\" class=\"form-control form-control-sm fieldlsb\" />");
		var fBorder = $("<select class=\"custom-select custom-select-sm fieldborder\" aria-label=\".custom-select-sm\"><option value=\"-1\">Border</option><option value=\"E\">East</option><option value=\"W\">West</option></select>");
		var fDirection = $("<select class=\"custom-select custom-select-sm fielddirection\" aria-label=\".custom-select-sm\"><option value=\"-1\">Direction</option><option value=\"I\">Input</option><option value=\"O\">Output</option></select>");
        var fWidth = $("<select class=\"custom-select custom-select-sm fieldwidth\" aria-label=\".custom-select-sm\"><option value=\"-1\">Width</option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option><option value=\"4\">4</option><option value=\"5\">5</option><option value=\"6\">6</option><option value=\"7\">7</option><option value=\"8\">8</option><option value=\"32\">32</option><option value=\"40\">40</option></select>");
        fWidth.change(function() {
			var widthVal = $(this).parent().find("select.fieldwidth").first().val();
			var fOldTile = $(this).parent().find("select.fieldtile");
			var fOldWire = $(this).parent().find("select.fieldwire");
			
			var fNewTile, fNewWire;
			if(widthVal <= 0){
				fNewTile = $("<select disabled=\"true\" class=\"custom-select custom-select-sm fieldtile\" aria-label=\".custom-select-sm\"><option value=\"-1\">Tile</option></select>");
				fNewWire = $("<select disabled=\"true\" class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wire(s)</option></select>");
			} else if(widthVal <= 8){
				fNewTile = $("<select class=\"custom-select custom-select-sm fieldtile\" aria-label=\".custom-select-sm\"><option value=\"-1\">CLB Tile</option><option value=\"C0\">CLB Y0 </option><option value=\"C1\">CLB Y1 </option><option value=\"C2\">CLB Y2 </option><option value=\"C3\">CLB Y3 </option><option value=\"C4\">CLB Y4 </option><option value=\"C5\">CLB Y5 </option><option value=\"C6\">CLB Y6 </option><option value=\"C7\">CLB Y7 </option><option value=\"C8\">CLB Y8 </option><option value=\"C9\">CLB Y9 </option><option value=\"C10\">CLB Y10</option><option value=\"C11\">CLB Y11</option><option value=\"C12\">CLB Y12</option><option value=\"C13\">CLB Y13</option><option value=\"C14\">CLB Y14</option><option value=\"C15\">CLB Y15</option><option value=\"C16\">CLB Y16</option><option value=\"C17\">CLB Y17</option><option value=\"C18\">CLB Y18</option><option value=\"C19\">CLB Y19</option><option value=\"C20\">CLB Y20</option><option value=\"C21\">CLB Y21</option><option value=\"C22\">CLB Y22</option><option value=\"C23\">CLB Y23</option><option value=\"C24\">CLB Y24</option><option value=\"C25\">CLB Y25</option><option value=\"C26\">CLB Y26</option><option value=\"C27\">CLB Y27</option><option value=\"C28\">CLB Y28</option><option value=\"C29\">CLB Y29</option><option value=\"C30\">CLB Y30</option><option value=\"C31\">CLB Y31</option><option value=\"C32\">CLB Y32</option><option value=\"C33\">CLB Y33</option><option value=\"C34\">CLB Y34</option><option value=\"C35\">CLB Y35</option><option value=\"C36\">CLB Y36</option><option value=\"C37\">CLB Y37</option><option value=\"C38\">CLB Y38</option><option value=\"C39\">CLB Y39</option><option value=\"C40\">CLB Y40</option><option value=\"C41\">CLB Y41</option><option value=\"C42\">CLB Y42</option><option value=\"C43\">CLB Y43</option><option value=\"C44\">CLB Y44</option><option value=\"C45\">CLB Y45</option><option value=\"C46\">CLB Y46</option><option value=\"C47\">CLB Y47</option><option value=\"C48\">CLB Y48</option><option value=\"C49\">CLB Y49</option><option value=\"C50\">CLB Y50</option><option value=\"C51\">CLB Y51</option><option value=\"C52\">CLB Y52</option><option value=\"C53\">CLB Y53</option><option value=\"C54\">CLB Y54</option><option value=\"C55\">CLB Y55</option><option value=\"C56\">CLB Y56</option><option value=\"C57\">CLB Y57</option><option value=\"C58\">CLB Y58</option><option value=\"C59\">CLB Y59</option></select>");
				if(widthVal == 1)fNewWire = $("<select class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wire</option><option value=\"0\">0</option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option><option value=\"4\">4</option><option value=\"5\">5</option><option value=\"6\">6</option><option value=\"7\">7</option></select>");
				else if(widthVal == 2)fNewWire = $("<select class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wires</option><option value=\"0\">0-1</option><option value=\"1\">1-2</option><option value=\"2\">2-3</option><option value=\"3\">3-4</option><option value=\"4\">4-5</option><option value=\"5\">5-6</option><option value=\"6\">6-7</option></select>");
				else if(widthVal == 3)fNewWire = $("<select class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wires</option><option value=\"0\">0-2</option><option value=\"1\">1-3</option><option value=\"2\">2-4</option><option value=\"3\">3-5</option><option value=\"4\">4-6</option><option value=\"5\">5-7</option></select>");
				else if(widthVal == 4)fNewWire = $("<select class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wires</option><option value=\"0\">0-3</option><option value=\"1\">1-4</option><option value=\"2\">2-5</option><option value=\"3\">3-6</option><option value=\"4\">4-7</option></select>");
				else if(widthVal == 5)fNewWire = $("<select class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wires</option><option value=\"0\">0-4</option><option value=\"1\">1-5</option><option value=\"2\">2-6</option><option value=\"3\">3-7</option></select>");
				else if(widthVal == 6)fNewWire = $("<select class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wires</option><option value=\"0\">0-5</option><option value=\"1\">1-6</option><option value=\"2\">2-7</option></select>");
				else if(widthVal == 7)fNewWire = $("<select class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wires</option><option value=\"0\">0-6</option><option value=\"1\">1-7</option></select>");
				else fNewWire = $("<select disabled=\"true\" class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"0\">0-7</option></select>");
			
			
			} else {
				fNewTile = $("<select class=\"custom-select custom-select-sm fieldtile\" aria-label=\".custom-select-sm\"><option value=\"-1\">BlockRAM Tile</option><option value=\"B0\">BRAM Y0 (CLB Y0-4)</option><option value=\"B1\">BRAM Y1 (CLB Y5-9)</option><option value=\"B2\">BRAM Y2 (CLB Y10-14)</option><option value=\"B3\">BRAM Y3 (CLB Y15-19)</option><option value=\"B4\">BRAM Y4 (CLB Y20-24)</option><option value=\"B5\">BRAM Y5 (CLB Y25-29)</option><option value=\"B6\">BRAM Y6 (CLB Y30-34)</option><option value=\"B7\">BRAM Y7 (CLB Y35-39)</option><option value=\"B8\">BRAM Y8 (CLB Y40-44)</option><option value=\"B9\">BRAM Y9 (CLB Y45-49)</option><option value=\"B10\">BRAM Y10 (CLB Y50-54)</option><option value=\"B11\">BRAM Y11 (CLB Y55-59)</option></select>");
				if( widthVal == 32) fNewWire = $("<select disabled=\"true\" class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">0-31</option></select>");
				else fNewWire = $("<select disabled=\"true\" class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">0-39</option></select>");
			}
			fOldTile.replaceWith(fNewTile);
			fOldWire.replaceWith(fNewWire);
        });
		var fClockRegion = $("<select class=\"custom-select custom-select-sm fieldclockregion\" aria-label=\".custom-select-sm\"><option value=\"-1\">Clock Region</option><option value=\"0\">0</option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option><option value=\"4\">4</option><option value=\"5\">5</option><option value=\"6\">6</option><option value=\"7\">7</option></select>");
        var fTile = $("<select disabled=\"true\" class=\"custom-select custom-select-sm fieldtile\" aria-label=\".custom-select-sm\"><option value=\"-1\">Tile</option></select>");
        var fWire = $("<select disabled=\"true\" class=\"custom-select custom-select-sm fieldwire\" aria-label=\".custom-select-sm\"><option value=\"-1\">Wire(s)</option></select>");
        var removeButton = $("<button class=\"btn btn-sm btn-danger remove btn-block\" type=\"button\" style=\"width:85px !important;\"><i class=\"fa fa-remove\"></i> Remove</button></div>");
        removeButton.click(function() {
            $(this).parent().remove();
        });
        fieldWrapper.append(fName);
        fieldWrapper.append(fLSB);
        fieldWrapper.append(fBorder);
        fieldWrapper.append(fDirection);
        fieldWrapper.append(fWidth);
        fieldWrapper.append(fClockRegion);
        fieldWrapper.append(fTile);
        fieldWrapper.append(fWire);
        fieldWrapper.append(removeButton);
        $("#interfacefieldset").append(fieldWrapper);
    });
    $("#preview").click(function() {
        $("#yourform").remove();
        var fieldSet = $("<fieldset id=\"yourform\"><legend>Your Form</legend></fieldset>");
        $("#interfacefieldset div").each(function() {
            var id = "input" + $(this).attr("id").replace("field","");
            var label = $("<label for=\"" + id + "\">" + $(this).find("input.fieldname").first().val() + "</label>");
            var input;
            switch ($(this).find("select.fieldtype").first().val()) {
                case "checkbox":
                    input = $("<input type=\"checkbox\" id=\"" + id + "\" name=\"" + id + "\" />");
                    break;
                case "textbox":
                    input = $("<input type=\"text\" id=\"" + id + "\" name=\"" + id + "\" />");
                    break;
                case "textarea":
                    input = $("<textarea id=\"" + id + "\" name=\"" + id + "\" ></textarea>");
                    break;    
            }
            fieldSet.append(label);
            fieldSet.append(input);
        });
        $("body").append(fieldSet);
    });
    $("#download").click(function() {
        download("Testfilename.txt", "Contents\nnewline");
    });
	
	
    $("#upload").click(function() {
        if (!window.File || !window.FileReader || !window.FileList || !window.Blob) {
          alert('The File APIs are not fully supported in this browser.');
          return;
        }   
      
        var input = document.getElementById('fileinput');
        if (!input) {
          alert("Um, couldn't find the fileinput element.");
        }
        else if (!input.files) {
          alert("This browser doesn't seem to support the `files` property of file inputs.");
        }
        else if (!input.files[0]) {
          alert("Please select a file before clicking 'Load'");               
        }
        else {
          var file = input.files[0];
          fr = new FileReader();
          fr.onload = receivedText;
          fr.readAsText(file);
          //fr.readAsBinaryString(file); //as bit work with base64 for example upload to server
          //fr.readAsDataURL(file);
        }
    });
    $("#draw").click(function() {
		readFromUI();
		
		/*console.log(interfaceRows);
		console.log(interfaceNames);
		console.log(interfaceLSBs);
		console.log(interfaceBorders);
		console.log(interfaceDirections);
		console.log(interfaceWidths);
		console.log(interfaceClockRegions);
		console.log(interfaceTiles);
		console.log(interfaceWires);*/
		
		var clockRegions = Math.max(interfaceClockRegions);
		
		
		
		$('canvas').remove();
		if(clockRegions >= 0){
			var Canvas_width = 512;
			var Canvas_height = (clockRegions+1)*(60*16+60*4) + (clockRegions)*(16);
			console.log(clockRegions);
			console.log(Canvas_height);
			var CanvasElement = $("<canvas width='" + Canvas_width + "' height='" + Canvas_height + "'></canvas>");
			var canvas = CanvasElement.get(0).getContext("2d");
			
			$("#maindiv").append(CanvasElement);
			//CanvasElement.appendTo('body');
			canvas.font = "20px Arial";
		//	canvas.fillStyle = "#ff0000"; // red
		//	canvas.fillRect(0, 0, Canvas_width, Canvas_height);
			//canvas.translate( 0, 0 );
			//canvas.rotate( Math.PI / 2 );
			
			//Module
			canvasRectangleWithBorder(canvas, 1.0, "#ade9ff", "#3dcbff", 3, 128, 64, 256, Canvas_height-68);
			//West Border
			canvas.fillText("West Border", 64, 16);
			canvas.fillText("outputs", 32, 48);
			canvas.fillText("inputs", 160, 48); 
			//canvas.restore();
			
			canvasLine(canvas, "#000000", 128, 32, 128, Canvas_height);
			canvasLine(canvas, "#000000", 129, 32, 129, Canvas_height);
			canvasArrow(canvas, "#000000", 128, 40, 112, 40);
			canvasArrow(canvas, "#000000", 128, 40, 144, 40); 
			//East Border
			canvas.fillText("East Border", 320, 16);
			canvas.fillText("inputs", 288, 48);
			canvas.fillText("outputs", 412, 48); 
			//canvas.restore();
			
			canvasLine(canvas, "#000000", 383, 32, 383, Canvas_height);
			canvasLine(canvas, "#000000", 384, 32, 384, Canvas_height);
			canvasArrow(canvas, "#000000", 384, 40, 368, 40);
			canvasArrow(canvas, "#000000", 384, 40, 400, 40); 
		}
    });
});
</script>  




















</div>
</main>

<nav class="navbar fixed-bottom navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="https://github.com/kmanev/DSPI" style="pointer-events: none;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;">DSPI</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapseBottom" aria-controls="navbarCollapseBottom" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarCollapseBottom">
    <ul class="navbar-nav mr-auto">
		<li class="nav-item">
			<a class="nav-link" href="#">Placeholder</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" href="#">Placeholder</a>
		</li>
    </ul>
  </div>
</nav>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>
